<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CreditPro</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <a href="/" class="logo">
        <div class="logo-icon">üí≥</div>
        <span>CreditPro</span>
      </a>
      <ul class="nav-links">
        <li><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a href="/calculator">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</a></li>
        <li><a href="/clients">–ö–ª–∏–µ–Ω—Ç—ã</a></li>
        <li><a href="/credits" class="active">–ö—Ä–µ–¥–∏—Ç—ã</a></li>
      </ul>
    </div>
  </nav>

  <div class="container main-content">
    <div class="page-header">
      <h1>–î–µ—Ç–∞–ª–∏ –∫—Ä–µ–¥–∏—Ç–∞</h1>
      <form action="/credits/<%= credit._id %>?_method=DELETE" method="POST" style="display: inline;">
        <button type="submit" class="btn btn-danger" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã?')">–£–¥–∞–ª–∏—Ç—å –∫—Ä–µ–¥–∏—Ç</button>
      </form>
    </div>

    <div class="detail-card">
      <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ</h2>
      <div class="detail-grid">
        <div class="detail-item">
          <span class="label">–§–ò–û:</span>
          <span class="value">
            <a href="/clients/<%= credit.client._id %>">
              <%= credit.client.lastName %> <%= credit.client.firstName %> <%= credit.client.middleName || '' %>
            </a>
          </span>
        </div>
        <div class="detail-item">
          <span class="label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
          <span class="value"><%= credit.client.phoneNumber %></span>
        </div>
        <div class="detail-item">
          <span class="label">Email:</span>
          <span class="value"><%= credit.client.email %></span>
        </div>
      </div>
    </div>

    <div class="detail-card">
      <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–µ–¥–∏—Ç–∞</h2>
      <div class="detail-grid">
        <div class="detail-item">
          <span class="label">–¢–∏–ø –∫—Ä–µ–¥–∏—Ç–∞:</span>
          <span class="value">
            <%
              const typeMap = {
                'consumer': '–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π',
                'mortgage': '–ò–ø–æ—Ç–µ–∫–∞',
                'car': '–ê–≤—Ç–æ–∫—Ä–µ–¥–∏—Ç',
                'business': '–ë–∏–∑–Ω–µ—Å'
              };
            %>
            <%= typeMap[credit.creditType] %>
          </span>
        </div>
        <div class="detail-item">
          <span class="label">–°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞:</span>
          <span class="value"><%= credit.amount.toLocaleString() %> —Å—É–º</span>
        </div>
        <div class="detail-item">
          <span class="label">–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞:</span>
          <span class="value"><%= credit.interestRate %>%</span>
        </div>
        <div class="detail-item">
          <span class="label">–°—Ä–æ–∫ –∫—Ä–µ–¥–∏—Ç–∞:</span>
          <span class="value"><%= credit.termMonths %> –º–µ—Å—è—Ü–µ–≤</span>
        </div>
        <div class="detail-item">
          <span class="label">–¢–∏–ø –ø–ª–∞—Ç–µ–∂–∞:</span>
          <span class="value"><%= credit.paymentType === 'annuity' ? '–ê–Ω–Ω—É–∏—Ç–µ—Ç–Ω—ã–π' : '–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π' %></span>
        </div>
        <div class="detail-item">
          <span class="label">–°—Ç–∞—Ç—É—Å:</span>
          <span class="value">
            <%
              const statusMap = {
                'active': '–ê–∫—Ç–∏–≤–Ω—ã–π',
                'closed': '–ó–∞–∫—Ä—ã—Ç',
                'overdue': '–ü—Ä–æ—Å—Ä–æ—á–µ–Ω'
              };
            %>
            <span class="status-badge status-<%= credit.status %>">
              <%= statusMap[credit.status] %>
            </span>
          </span>
        </div>
      </div>
    </div>

    <div class="detail-card">
      <h2>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h2>
      <div class="detail-grid highlight">
        <div class="detail-item">
          <span class="label">–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂:</span>
          <span class="value"><%= credit.monthlyPayment.toLocaleString() %> —Å—É–º</span>
        </div>
        <div class="detail-item">
          <span class="label">–û–±—â–∞—è —Å—É–º–º–∞ –≤—ã–ø–ª–∞—Ç:</span>
          <span class="value"><%= credit.totalPayment.toLocaleString() %> —Å—É–º</span>
        </div>
        <div class="detail-item">
          <span class="label">–ü–µ—Ä–µ–ø–ª–∞—Ç–∞:</span>
          <span class="value"><%= credit.totalInterest.toLocaleString() %> —Å—É–º</span>
        </div>
        <div class="detail-item">
          <span class="label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:</span>
          <span class="value"><%= new Date(credit.startDate).toLocaleDateString('ru-RU') %></span>
        </div>
        <div class="detail-item">
          <span class="label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è:</span>
          <span class="value"><%= new Date(credit.endDate).toLocaleDateString('ru-RU') %></span>
        </div>
      </div>
    </div>

    <div class="detail-card">
      <h2>–ì—Ä–∞—Ñ–∏–∫ –ø–ª–∞—Ç–µ–∂–µ–π</h2>
      <div class="table-container">
        <table class="payment-table">
          <thead>
            <tr>
              <th>‚Ññ</th>
              <th>–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞</th>
              <th>–ü–ª–∞—Ç–µ–∂</th>
              <th>–û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–ª–≥</th>
              <th>–ü—Ä–æ—Ü–µ–Ω—Ç—ã</th>
              <th>–û—Å—Ç–∞—Ç–æ–∫</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
            </tr>
          </thead>
          <tbody>
            <% payments.forEach(payment => { %>
              <tr>
                <td><%= payment.paymentNumber %></td>
                <td><%= new Date(payment.paymentDate).toLocaleDateString('ru-RU') %></td>
                <td><%= payment.totalAmount.toLocaleString() %> —Å—É–º</td>
                <td><%= payment.principalAmount.toLocaleString() %> —Å—É–º</td>
                <td><%= payment.interestAmount.toLocaleString() %> —Å—É–º</td>
                <td><%= payment.remainingBalance.toLocaleString() %> —Å—É–º</td>
                <td>
                  <% if (payment.isPaid) { %>
                    <span class="status-badge status-paid">–û–ø–ª–∞—á–µ–Ω</span>
                  <% } else { %>
                    <span class="status-badge status-pending">–û–∂–∏–¥–∞–µ—Ç</span>
                  <% } %>
                </td>
              </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
    </div>

    <a href="/credits" class="btn btn-secondary">–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
  </div>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2024 CreditPro. –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞–º–∏.</p>
    </div>
  </footer>
</body>
</html>
